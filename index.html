<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="description" content="The DIY Decider ‚Äî 5 questions. 1 straight answer. Find out if you should tackle your home project yourself or call a pro.">
<title>The DIY Decider</title>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-THPQQG9ZB4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-THPQQG9ZB4');
</script>

<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Barlow+Condensed:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
* { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

body {
  background: #f5f0e8;
  font-family: 'Barlow Condensed', sans-serif;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  align-items: center;
}

/* NAV */
nav {
  width: 100%;
  background: #1a1a1a;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.8rem 1.5rem;
}
.nav-logo {
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.3rem;
  letter-spacing: 0.04em;
  color: #fff;
  text-decoration: none;
}
.nav-logo span { color: #ffd700; }
.nav-links { display: flex; gap: 1.5rem; align-items: center; }
.nav-links a {
  font-size: 0.7rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: #888;
  text-decoration: none;
  transition: color 0.2s;
}
.nav-links a:hover, .nav-links a.active { color: #ffd700; }

/* HEADER BANNER */
.site-header {
  width: 100%;
  background: #c0392b;
  padding: 1.5rem 1.5rem 1.2rem;
  text-align: center;
  border-bottom: 4px solid #1a1a1a;
}
.site-header .eyebrow {
  font-size: 0.6rem;
  font-weight: 700;
  letter-spacing: 0.22em;
  color: rgba(255,255,255,0.6);
  text-transform: uppercase;
  margin-bottom: 0.3rem;
}
.site-header h1 {
  font-family: 'Bebas Neue', sans-serif;
  font-size: clamp(2.4rem, 8vw, 3.8rem);
  letter-spacing: 0.04em;
  color: #fff;
  line-height: 1;
}
.site-header h1 span { color: #ffd700; }
.site-header .tagline {
  font-size: 0.65rem;
  font-weight: 600;
  letter-spacing: 0.18em;
  color: rgba(255,255,255,0.55);
  text-transform: uppercase;
  margin-top: 0.4rem;
}

/* MAIN CONTENT */
main {
  width: 100%;
  max-width: 520px;
  padding: 1.8rem 1rem 3rem;
  flex: 1;
}

/* CARD */
.card {
  background: #fff;
  border: 2px solid #1a1a1a;
  border-radius: 2px;
  box-shadow: 4px 4px 0 #1a1a1a;
  overflow: hidden;
}

.card-header {
  background: #1a1a1a;
  padding: 0.6rem 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.card-header-label {
  font-size: 0.6rem;
  font-weight: 700;
  letter-spacing: 0.18em;
  color: #ffd700;
  text-transform: uppercase;
}
.card-header-dots {
  display: flex; gap: 4px;
}
.card-header-dots span {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: #333;
}

.card-body {
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 1.1rem;
  min-height: 280px;
  justify-content: center;
}

/* INPUT */
.field-label {
  font-size: 0.65rem;
  font-weight: 800;
  letter-spacing: 0.16em;
  color: #999;
  text-transform: uppercase;
  margin-bottom: 0.4rem;
}
input[type="text"] {
  background: #f9f9f9;
  border: 2px solid #1a1a1a;
  border-radius: 0;
  padding: 0.85rem 1rem;
  color: #1a1a1a;
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 16px;
  font-weight: 600;
  width: 100%;
  outline: none;
  -webkit-appearance: none;
  transition: border-color 0.15s;
}
input[type="text"]:focus { border-color: #c0392b; }

.error-msg {
  color: #c0392b;
  font-size: 0.75rem;
  font-weight: 700;
  letter-spacing: 0.04em;
  word-break: break-word;
}

/* BUTTONS */
.btn-main {
  background: #1a1a1a;
  color: #ffd700;
  border: 2px solid #1a1a1a;
  border-radius: 0;
  padding: 0.95rem;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.1rem;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  cursor: pointer;
  width: 100%;
  transition: opacity 0.1s, transform 0.1s;
  box-shadow: 3px 3px 0 #c0392b;
}
.btn-main:disabled {
  background: #ddd;
  color: #aaa;
  border-color: #ddd;
  box-shadow: none;
  cursor: not-allowed;
}
.btn-main:active { opacity: 0.85; transform: scale(0.98); }

/* DIVIDER */
.hw-divider {
  height: 2px;
  background: repeating-linear-gradient(90deg, #1a1a1a 0, #1a1a1a 8px, transparent 8px, transparent 14px);
  margin: 0.2rem 0;
}

/* LOADING */
.loading-section { text-align: center; padding: 1rem 0; }
.spinner {
  display: inline-block;
  width: 32px; height: 32px;
  border: 3px solid #eee;
  border-top-color: #c0392b;
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
  margin-bottom: 1rem;
}
@keyframes spin { to { transform: rotate(360deg); } }
.loading-section p {
  font-size: 0.75rem;
  font-weight: 700;
  color: #999;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}

/* QUESTIONS */
.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.4rem;
}
.progress-badge {
  background: #c0392b;
  color: #fff;
  font-size: 0.55rem;
  font-weight: 800;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  padding: 0.2rem 0.6rem;
}
.progress-pct {
  font-size: 0.6rem;
  font-weight: 700;
  color: #bbb;
  letter-spacing: 0.08em;
}
.progress-track {
  height: 5px;
  background: #eee;
  border: 1px solid #ddd;
}
.progress-fill {
  height: 100%;
  background: #c0392b;
  transition: width 0.4s ease;
}

.question-text {
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 1.25rem;
  font-weight: 700;
  color: #1a1a1a;
  line-height: 1.4;
  min-height: 3.6em;
}

.yn-buttons { display: flex; gap: 0.8rem; }
.btn-yes {
  flex: 1;
  background: #2d7a2d;
  color: #fff;
  border: 2px solid #1a1510;
  border-radius: 0;
  padding: 1rem;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.1rem;
  letter-spacing: 0.1em;
  cursor: pointer;
  text-align: center;
  box-shadow: 3px 3px 0 #1a1a1a;
  transition: opacity 0.1s, transform 0.1s;
}
.btn-no {
  flex: 1;
  background: #c0392b;
  color: #fff;
  border: 2px solid #1a1a1a;
  border-radius: 0;
  padding: 1rem;
  font-family: 'Bebas Neue', sans-serif;
  font-size: 1.1rem;
  letter-spacing: 0.1em;
  cursor: pointer;
  text-align: center;
  box-shadow: 3px 3px 0 #1a1a1a;
  transition: opacity 0.1s, transform 0.1s;
}
.btn-yes:active, .btn-no:active { opacity: 0.8; transform: scale(0.97); box-shadow: 1px 1px 0 #1a1a1a; }

.dots { display: flex; gap: 5px; justify-content: center; align-items: center; }
.dot {
  height: 6px; border-radius: 1px;
  background: #ddd;
  transition: all 0.3s ease;
}
.dot.done { background: #c0392b; width: 6px; }
.dot.active { background: #1a1a1a; width: 20px; }
.dot.upcoming { width: 6px; }

/* DELIBERATING */
.deliberating-section { text-align: center; padding: 1rem 0; }
.wheel-wrap { position: relative; width: 140px; height: 140px; margin: 0 auto 1.5rem; }
.wheel-glow {
  position: absolute;
  top: -4px; right: -4px; bottom: -4px; left: -4px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(192,57,43,0.1) 0%, transparent 70%);
  pointer-events: none;
}
#wheelSvg {
  transition: transform 0.55s cubic-bezier(0.25,0.46,0.45,0.94);
  -webkit-transition: -webkit-transform 0.55s cubic-bezier(0.25,0.46,0.45,0.94);
}
.wheel-pointer {
  position: absolute;
  top: -10px; left: 50%;
  transform: translateX(-50%);
  -webkit-transform: translateX(-50%);
  width: 0; height: 0;
  border-left: 8px solid transparent;
  border-right: 8px solid transparent;
  border-top: 16px solid #c0392b;
  z-index: 10;
}
.deliberating-phrase {
  font-size: 0.75rem;
  font-weight: 700;
  color: #999;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  min-height: 1.3em;
}

/* VERDICT */
.verdict-section { display: flex; flex-direction: column; gap: 1rem; animation: fadeUp 0.5s ease; }
@keyframes fadeUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.verdict-banner {
  padding: 1.5rem 1.2rem;
  text-align: center;
  border: 2px solid #1a1a1a;
}
.verdict-emoji { font-size: 2rem; margin-bottom: 0.5rem; }
.verdict-label {
  font-family: 'Bebas Neue', sans-serif;
  font-size: clamp(1.6rem, 6vw, 2.2rem);
  letter-spacing: 0.04em;
  line-height: 1;
}
.verdict-tagline {
  font-size: 0.6rem;
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  margin-top: 0.4rem;
  opacity: 0.6;
}

.info-block {
  background: #f9f9f9;
  border: 2px solid #1a1a1a;
  border-left: 5px solid #c0392b;
  padding: 0.9rem 1rem;
}
.info-block-label {
  font-size: 0.6rem;
  font-weight: 800;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: #c0392b;
  margin-bottom: 0.4rem;
}
.info-block p {
  font-size: 0.95rem;
  font-weight: 600;
  color: #333;
  line-height: 1.6;
}

.btn-reset {
  background: transparent;
  border: 2px solid #ddd;
  border-radius: 0;
  padding: 0.8rem;
  color: #aaa;
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  cursor: pointer;
  width: 100%;
  transition: border-color 0.2s, color 0.2s;
  -webkit-appearance: none;
}
.btn-reset:active { opacity: 0.7; }

/* FOOTER */
footer {
  width: 100%;
  background: #1a1a1a;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: auto;
}
.footer-left {
  font-size: 0.6rem;
  font-weight: 700;
  color: #444;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}
.btn-coffee {
  display: inline-block;
  background: #ffd700;
  color: #1a1a1a;
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 0.7rem;
  font-weight: 800;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  text-decoration: none;
  padding: 0.45rem 0.9rem;
  border: 2px solid #ffd700;
  transition: opacity 0.15s;
}
.btn-coffee:active { opacity: 0.8; }

.hidden { display: none !important; }
</style>
</head>
<body>

<nav>
  <a href="index.html" class="nav-logo">The DIY <span>Decider</span></a>
  <div class="nav-links">
    <a href="index.html" class="active">Tool</a>
    <a href="about.html">About</a>
  </div>
</nav>

<div class="site-header">
  <div class="eyebrow">Est. 2025 ¬∑ Straight Talk Only</div>
  <h1>THE DIY <span>DECIDER</span></h1>
  <div class="tagline">5 questions ¬∑ 1 straight answer ¬∑ no ego</div>
</div>

<main>
  <div class="card">
    <div class="card-header">
      <span class="card-header-label" id="cardHeaderLabel">Start Your Assessment</span>
      <div class="card-header-dots">
        <span></span><span></span><span></span>
      </div>
    </div>

    <div class="card-body">

      <!-- INPUT -->
      <div id="stage-input">
        <div class="field-label">What's the project?</div>
        <input type="text" id="projectInput" placeholder="e.g. Replace a bathroom faucet..." />
        <div id="errorMsg" class="error-msg hidden"></div>
        <div class="hw-divider"></div>
        <button class="btn-main" id="btnStart" onclick="startProject()">Let's Find Out ‚Üí</button>
      </div>

      <!-- LOADING -->
      <div id="stage-loading-q" class="loading-section hidden">
        <div class="spinner"></div>
        <p>Sizing up your project...</p>
      </div>

      <!-- QUESTIONS -->
      <div id="stage-questions" class="hidden">
        <div class="progress-header">
          <span class="progress-badge" id="progressBadge">Question 1 of 5</span>
          <span class="progress-pct" id="progressPct">Just getting started</span>
        </div>
        <div class="progress-track">
          <div class="progress-fill" id="progressFill" style="width:0%"></div>
        </div>
        <div class="hw-divider" style="margin-top:0.8rem"></div>
        <p class="question-text" id="questionText"></p>
        <div class="yn-buttons">
          <button class="btn-yes" onclick="submitAnswer('Yes')">‚úì &nbsp;Yes</button>
          <button class="btn-no"  onclick="submitAnswer('No')">‚úó &nbsp;No</button>
        </div>
        <div class="dots" id="dots"></div>
      </div>

      <!-- DELIBERATING -->
      <div id="stage-deliberating" class="deliberating-section hidden">
        <div class="wheel-wrap">
          <div class="wheel-glow"></div>
          <svg id="wheelSvg" width="140" height="140" viewBox="0 0 140 140"></svg>
          <div class="wheel-pointer"></div>
        </div>
        <p class="deliberating-phrase" id="deliberatingPhrase">Cross-referencing your answers...</p>
      </div>

      <!-- VERDICT -->
      <div id="stage-verdict" class="verdict-section hidden">
        <div class="verdict-banner" id="verdictBanner">
          <div class="verdict-emoji" id="verdictEmoji"></div>
          <div class="verdict-label" id="verdictLabel"></div>
          <div class="verdict-tagline" id="verdictTagline"></div>
        </div>
        <div class="info-block">
          <div class="info-block-label" id="reasoningLabel">üí¨ &nbsp;The Verdict</div>
          <p id="reasoningText"></p>
        </div>
        <div class="info-block" style="border-left-color:#888">
          <div class="info-block-label" style="color:#888">üí∞ &nbsp;What a Pro Would Cost You</div>
          <p id="costText"></p>
        </div>
        <div class="info-block hidden" id="resourcesBlock" style="border-left-color:#2d7a2d">
          <div class="info-block-label" style="color:#2d7a2d">üìö &nbsp;Where to Learn</div>
          <p id="resourcesText"></p>
        </div>
        <button class="btn-reset" onclick="reset()">‚Üê Try Another Project</button>
      </div>

    </div>
  </div>
</main>

<footer>
  <span class="footer-left">The DIY Decider ¬∑ Powered by Claude</span>
  <a href="https://buymeacoffee.com/thediydecider" target="_blank" class="btn-coffee">‚òï Buy Dave a Coffee</a>
</footer>

<script>
const PHRASES = [
  "Cross-referencing your answers...",
  "Consulting 40 years of experience...",
  "Running the numbers...",
  "Checking if you're kidding...",
  "Almost ready to judge you...",
  "The verdict is in.",
];

let questions = [], answers = [], currentQ = 0;
let wheelRotation = 0, wheelInterval = null, wheelTimeout = null;
let phraseIndex = 0, pendingResult = null, wheelDone = false;

// Build wheel
(function buildWheel() {
  const svg = document.getElementById('wheelSvg');
  const fills = ["#c0392b","#1a1a1a","#e74c3c","#111","#c0392b","#1a1a1a","#e74c3c","#111"];
  const count = fills.length, r = 58, cx = 70, cy = 70;
  fills.forEach((fill, i) => {
    const angle = 360 / count;
    const s = (i * angle - 90) * Math.PI / 180;
    const e = ((i * angle - 90) + angle) * Math.PI / 180;
    const x1 = cx + r * Math.cos(s), y1 = cy + r * Math.sin(s);
    const x2 = cx + r * Math.cos(e), y2 = cy + r * Math.sin(e);
    const path = document.createElementNS("http://www.w3.org/2000/svg","path");
    path.setAttribute("d", `M ${cx} ${cy} L ${x1} ${y1} A ${r} ${r} 0 0 1 ${x2} ${y2} Z`);
    path.setAttribute("fill", fill);
    path.setAttribute("stroke", "#f5f0e8");
    path.setAttribute("stroke-width", "1.5");
    svg.appendChild(path);
  });
  const hub = document.createElementNS("http://www.w3.org/2000/svg","circle");
  hub.setAttribute("cx",70); hub.setAttribute("cy",70); hub.setAttribute("r",16);
  hub.setAttribute("fill","#f5f0e8"); hub.setAttribute("stroke","#ddd"); hub.setAttribute("stroke-width","1.5");
  svg.appendChild(hub);
  const dot = document.createElementNS("http://www.w3.org/2000/svg","circle");
  dot.setAttribute("cx",70); dot.setAttribute("cy",70); dot.setAttribute("r",7); dot.setAttribute("fill","#c0392b");
  svg.appendChild(dot);
})();

function showStage(name) {
  ['input','loading-q','questions','deliberating','verdict'].forEach(s => {
    document.getElementById('stage-'+s).classList.add('hidden');
  });
  document.getElementById('stage-'+name).classList.remove('hidden');
  const labels = {
    'input': 'Start Your Assessment',
    'loading-q': 'Analyzing Project...',
    'questions': 'Answer Honestly',
    'deliberating': 'Rendering Judgment...',
    'verdict': 'The Verdict Is In'
  };
  document.getElementById('cardHeaderLabel').textContent = labels[name] || '';
}

function showError(msg) {
  const el = document.getElementById('errorMsg');
  el.textContent = msg;
  el.classList.remove('hidden');
}
function hideError() { document.getElementById('errorMsg').classList.add('hidden'); }

function updateDots() {
  const c = document.getElementById('dots');
  c.innerHTML = '';
  for (let i = 0; i < 5; i++) {
    const d = document.createElement('div');
    d.className = 'dot ' + (i < currentQ ? 'done' : i === currentQ ? 'active' : 'upcoming');
    c.appendChild(d);
  }
}

function updateProgress() {
  document.getElementById('progressBadge').textContent = `Question ${currentQ+1} of 5`;
  const labels = ["Just getting started", "25% done", "Halfway there", "Almost done", "Last one"];
  document.getElementById('progressPct').textContent = labels[currentQ] || '';
  document.getElementById('progressFill').style.width = `${(currentQ/5)*100}%`;
  updateDots();
}

async function startProject() {
  const project = document.getElementById('projectInput').value.trim();
  if (!project) return;
  hideError();
  showStage('loading-q');

  // Track event
  gtag('event', 'project_started', { project_name: project });

  try {
    const res = await fetch("/questions", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ project })
    });
    const data = await res.json();
    if (data.error) { showError("Error: " + data.error); showStage('input'); return; }
    questions = data.questions.slice(0, 5);
    answers = []; currentQ = 0;
    showStage('questions');
    document.getElementById('questionText').textContent = questions[0].q;
    updateProgress();
  } catch(e) {
    showError("Error: " + (e.message || "Something went wrong"));
    showStage('input');
  }
}

async function submitAnswer(answer) {
  answers.push(answer);
  if (currentQ < 4) {
    currentQ++;
    document.getElementById('questionText').textContent = questions[currentQ].q;
    updateProgress();
  } else {
    wheelDone = false; pendingResult = null;
    showStage('deliberating');
    startWheel();
    const project = document.getElementById('projectInput').value.trim();
    try {
      const res = await fetch("/verdict", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ project, questions, answers })
      });
      const data = await res.json();
      if (data.error) { stopWheel(); showError("Error: " + data.error); showStage('input'); return; }
      if (wheelDone) { showVerdict(data); } else { pendingResult = data; }
    } catch(e) {
      stopWheel();
      showError("Couldn't get verdict: " + (e.message || "Try again"));
      showStage('input');
    }
  }
}

function startWheel() {
  const svg = document.getElementById('wheelSvg');
  phraseIndex = 0;
  document.getElementById('deliberatingPhrase').textContent = PHRASES[0];
  wheelInterval = setInterval(() => {
    phraseIndex = Math.min(phraseIndex + 1, PHRASES.length - 1);
    document.getElementById('deliberatingPhrase').textContent = PHRASES[phraseIndex];
    wheelRotation += 55 + Math.random() * 30;
    svg.style.transform = `rotate(${wheelRotation}deg)`;
    svg.style.webkitTransform = `rotate(${wheelRotation}deg)`;
  }, 1100);
  wheelTimeout = setTimeout(() => {
    stopWheel();
    wheelDone = true;
    if (pendingResult) setTimeout(() => showVerdict(pendingResult), 400);
  }, 7000);
}

function stopWheel() {
  clearInterval(wheelInterval);
  clearTimeout(wheelTimeout);
}

function showVerdict(data) {
  const isDIY = data.verdict === "DIY";

  const banner = document.getElementById('verdictBanner');
  banner.style.background = isDIY ? '#f0fdf4' : '#fff5f5';
  banner.style.borderColor = isDIY ? '#2d7a2d' : '#c0392b';

  document.getElementById('verdictEmoji').textContent = isDIY ? "üî®" : "üìû";
  document.getElementById('verdictLabel').textContent = isDIY ? "DO IT YOURSELF" : "CALL A PRO";
  document.getElementById('verdictLabel').style.color = isDIY ? '#2d7a2d' : '#c0392b';
  document.getElementById('verdictTagline').textContent = isDIY ? "You've got this one." : "Nothing wrong with knowing your limits.";
  document.getElementById('verdictTagline').style.color = isDIY ? '#2d7a2d' : '#c0392b';

  document.getElementById('reasoningLabel').style.color = isDIY ? '#2d7a2d' : '#c0392b';
  document.getElementById('reasoningText').textContent = data.reasoning;
  document.getElementById('costText').textContent = data.cost;

  if (isDIY && data.resources) {
    document.getElementById('resourcesText').textContent = data.resources;
    document.getElementById('resourcesBlock').classList.remove('hidden');
  } else {
    document.getElementById('resourcesBlock').classList.add('hidden');
  }

  // Track verdict
  gtag('event', 'verdict_received', { verdict: data.verdict });

  showStage('verdict');
}

function reset() {
  stopWheel();
  questions = []; answers = []; currentQ = 0;
  wheelDone = false; pendingResult = null; wheelRotation = 0;
  document.getElementById('projectInput').value = '';
  hideError();
  showStage('input');
}

document.getElementById('projectInput').addEventListener('keydown', function(e) {
  if (e.key === 'Enter') startProject();
});
</script>
</body>
</html>
